jQuery(document).ready((function(n){function o(o,i="info",t=4){n("body").append('<div class="notification-message">'+o+'<a href="#" class="close"><i class="icon-close"></i></a></div>'),n(".notification-message").fadeIn(),window.setTimeout((function(){n(".notification-message").fadeOut(),n(".notification-message").remove()}),1e3*t)}function i(n,o){e({action:"cbsb_settings_update",settings:[{name:n,value:o}]})}function t(i,t,e){var a={action:"cbsb_editor_update",step:i,key:t,value:e};n.post(ajaxurl,a,(function(n){o(n.message,n.status,5)}))}function e(i){n.post(ajaxurl,i,(function(n){o(n.message,n.status,5),n.reload&&window.setTimeout((function(){window.location.reload()}),1e3)}))}n.post(ajaxurl,{action:"cbsb_check_connection"},(function(o){o.data.hasOwnProperty("data")?n("#connection_indicator").addClass("led_green"):n("#connection_indicator").addClass("led_red")})),n("#booking-page-submit").on("click",(function(i){i.preventDefault();var t=n("#booking-page option:selected").val(),e={action:"cbsb_update_booking_page",booking_page:t};"Select a page"!=t&&n.post(ajaxurl,e,(function(n){o(n.message,n.status,5),n.reload&&window.setTimeout((function(){window.location.reload()}),1e3)}))})),"none"==n("#booking-window-start-type").val()&&n("#booking-window-start-qty").hide(),"none"==n("#booking-window-end-type").val()&&n("#booking-window-end-qty").hide(),n("#booking-window-start-type").change((function(){"none"!==n("#booking-window-start-type").val()?n("#booking-window-start-qty").show():n("#booking-window-start-qty").hide(),t("settings","booking_window_start_type",n("#booking-window-start-type").val())})),n("#booking-window-end-type").change((function(){"none"!==n("#booking-window-end-type").val()?n("#booking-window-end-qty").show():n("#booking-window-end-qty").hide(),t("settings","booking_window_end_type",n("#booking-window-end-type").val())})),n("#booking-window-start-qty").focus((function(){window.cbsb_booking_window_start_qty=n("#booking-window-start-qty").val()})),n("#booking-window-end-qty").focus((function(){window.cbsb_booking_window_end_qty=n("#booking-window-end-qty").val()})),n("#booking-window-start-qty").blur((function(){n("#booking-window-start-qty").val()!=window.cbsb_booking_window_start_qty&&t("settings","booking_window_start_qty",n("#booking-window-start-qty").val())})),n("#booking-window-end-qty").blur((function(){n("#booking-window-end-qty").val()!=window.cbsb_booking_window_end_qty&&t("settings","booking_window_end_qty",n("#booking-window-end-qty").val())})),n("#api-communication").change((function(){i("api_communication",n("#api-communication").val())})),n("#endorse").click((function(){i("endorse_us",n(this).is(":checked"))})),n("#additional_data").click((function(){t("settings","allow_data_collection",n(this).is(":checked"))})),n("#appointment-use-visitor-timezone").change((function(){t("settings","use_visitor_timezone",n("#appointment-use-visitor-timezone").val())})),n("#disable").click((function(){i("disable_booking",n(this).is(":checked"))})),n("button#reconnect").click((function(i){i.preventDefault(),n(this).addClass("loading"),n(this).html("..."),n(this).prop("disabled",!0);var t={action:"cbsb_app_reconnect_account",email:n("#reconnect_row input[name=reconnect_email]").val(),password:n("#reconnect_row input[name=reconnect_password]").val()};n.post(ajaxurl,t,(function(n){o(n.message,n.status,5),n.reload&&window.setTimeout((function(){window.location.reload()}),1e3)}))}))}));
